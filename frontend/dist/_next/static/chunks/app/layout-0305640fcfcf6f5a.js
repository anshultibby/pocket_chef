(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{5741:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,347,23)),Promise.resolve().then(a.t.bind(a,2807,23)),Promise.resolve().then(a.t.bind(a,9574,23)),Promise.resolve().then(a.bind(a,7454)),Promise.resolve().then(a.bind(a,6381))},7454:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>l});var r=a(5155),n=a(2115),i=a(1712),o=a(2870),s=a(6046),c=a(7599);function l(e){let{children:t}=e,[a,l]=(0,n.useState)(null),[u,d]=(0,n.useState)(null),[h,p]=(0,n.useState)(!0),[w,f]=(0,n.useState)(null),y=(0,s.useRouter)();(0,n.useEffect)(()=>{(async()=>{try{var e;let{data:{session:t},error:a}=await i.N.auth.getSession();if(a)throw a;d(t),l(null!==(e=null==t?void 0:t.user)&&void 0!==e?e:null);let{data:{subscription:r}}=i.N.auth.onAuthStateChange(async(e,t)=>{var a;d(t),l(null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null),y.refresh()});return()=>r.unsubscribe()}catch(e){console.error("Auth initialization error:",e),f(e instanceof Error?e:Error("Auth initialization failed"))}finally{p(!1)}})()},[y]);let m=(0,n.useMemo)(()=>({user:a,session:u,loading:h,error:w,signIn:async(e,t)=>{let{error:a}=await i.N.auth.signInWithPassword({email:e,password:t});if(a)throw a},signUp:async(e,t,a)=>{let{data:r,error:n}=await i.N.auth.signUp({email:e,password:t,options:{data:{name:a}}});if(n)throw n;if(r.session){d(r.session),l(r.session.user);try{return await c.gu.createProfile(),y.push("/onboarding"),{session:r.session,isNewUser:!0}}catch(e){console.error("Error creating profile:",e)}}return{session:r.session,isNewUser:!0}},signOut:async()=>{let{error:e}=await i.N.auth.signOut();if(e)throw e;y.push("/login")}}),[a,u,h,w,y]);return(0,r.jsx)(o.c.Provider,{value:m,children:t})}},6381:(e,t,a)=>{"use strict";a.d(t,{AnalyticsProvider:()=>u});var r=a(5155),n=a(2115),i=()=>{window.va||(window.va=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];(window.vaq=window.vaq||[]).push(t)})};function o(){return"undefined"!=typeof window}function s(){return"production"}function c(){return"development"===((o()?window.vam:s())||"production")}function l(e){return(0,n.useEffect)(()=>{var t;e.beforeSend&&(null==(t=window.va)||t.call(window,"beforeSend",e.beforeSend))},[e.beforeSend]),(0,n.useEffect)(()=>{!function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{debug:!0};if(!o())return;(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto";if("auto"===e){window.vam=s();return}window.vam=e})(t.mode),i(),t.beforeSend&&(null==(e=window.va)||e.call(window,"beforeSend",t.beforeSend));let a=t.scriptSrc||(c()?"https://va.vercel-scripts.com/v1/script.debug.js":"/_vercel/insights/script.js");if(document.head.querySelector('script[src*="'.concat(a,'"]')))return;let r=document.createElement("script");r.src=a,r.defer=!0,r.dataset.sdkn="@vercel/analytics"+(t.framework?"/".concat(t.framework):""),r.dataset.sdkv="1.4.1",t.disableAutoTrack&&(r.dataset.disableAutoTrack="1"),t.endpoint&&(r.dataset.endpoint=t.endpoint),t.dsn&&(r.dataset.dsn=t.dsn),r.onerror=()=>{let e=c()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log("[Vercel Web Analytics] Failed to load script from ".concat(a,". ").concat(e))},c()&&!1===t.debug&&(r.dataset.debug="false"),document.head.appendChild(r)}({framework:e.framework||"react",...void 0!==e.route&&{disableAutoTrack:!0},...e})},[]),(0,n.useEffect)(()=>{e.route&&e.path&&function(e){var t;let{route:a,path:r}=e;null==(t=window.va)||t.call(window,"pageview",{route:a,path:r})}({route:e.route,path:e.path})},[e.route,e.path]),null}function u(){return(0,r.jsx)(l,{})}},7599:(e,t,a)=>{"use strict";a.d(t,{dt:()=>s,gu:()=>l,Hv:()=>c});var r=a(1712);class n extends Error{constructor(e){super(e.message),this.error=e,this.name="ApiException"}}let i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let{data:{session:a}}=await r.N.auth.getSession();if(!(null==a?void 0:a.access_token))throw new n({status:401,message:"No active session"});let o=new Headers(t.headers);o.set("Authorization","Bearer ".concat(a.access_token));let s=await fetch("".concat("https://pocketchef-production.up.railway.app/").concat(e),{...t,headers:o,credentials:"include"});if(401===s.status){let{data:{session:a}}=await r.N.auth.refreshSession();if(null==a?void 0:a.access_token)return o.set("Authorization","Bearer ".concat(a.access_token)),i(e,t);throw new n({status:401,message:"Session expired"})}if(!s.ok)throw new n({status:s.status,message:"Request failed"});return s.json()}catch(e){if(e instanceof n)throw e;throw new n({status:500,message:"Network error",details:e})}},o=async()=>{let{data:{session:e}}=await r.N.auth.getSession();if(!e)throw Error("Not authenticated");return e.access_token},s={async getItems(){let e=await o();return i("/pantry/items",{headers:{Authorization:"Bearer ".concat(e)}})},async addItems(e){let t=await o();return i("/pantry/items",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(e)})},async updateItem(e,t){let a=await o();return i("/pantry/items/".concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(t)})},async deleteItem(e){let t=await o();return i("/pantry/items/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})},async clearPantry(){let e=await o();return i("/pantry/clear",{method:"POST",headers:{Authorization:"Bearer ".concat(e)}})},processReceipt:async e=>{let t=await o();return i("/pantry/receipt/process",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:e})},receipt:{process:async e=>{let t=await o();return i("/pantry/receipt/process",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:e})}}},c={generate:async e=>{let t=await o();return i("/recipes/generate",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(e)})},linkIngredients:async e=>{let t=await o();return i("/recipes/".concat(e,"/link-ingredients"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)}})},getRecipeDetails:async e=>{let t=await o();return i("/recipes/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})},delete:async e=>{let t=await o();return i("/recipes/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})},interact:async(e,t)=>{let a=await o();return i("/recipes/".concat(e,"/interact"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(t)})},getInteractions:async(e,t)=>{let a=await o();return i("".concat(e?"/recipes/".concat(e,"/interactions"):"/recipes/interactions").concat(t?"?interaction_type=".concat(t):""),{headers:{Authorization:"Bearer ".concat(a)}})},isSaveData:e=>"folder"in e||"notes"in e,saveRecipe:async(e,t)=>{try{return await c.interact(e,{type:"save",data:{folder:t}})}catch(t){if(t instanceof Error&&t.message.includes("duplicate key value")){let t=await c.getInteractions(e,"save");if(t.length>0)return t[0]}throw t}},rateRecipe:async(e,t,a)=>{let r=(await c.getInteractions(e)).find(e=>"rate"===e.type);return r?i("/recipes/".concat(e,"/interactions/").concat(r.id),{method:"PATCH",headers:{Authorization:"Bearer ".concat(await o()),"Content-Type":"application/json"},body:JSON.stringify({type:"rate",data:{rating:t,review:a}})}):c.interact(e,{type:"rate",data:{rating:t,review:a}})},use:async(e,t)=>c.interact(e,{type:"cook",data:t}),getAll:async()=>{let e=await o();return i("/recipes",{headers:{Authorization:"Bearer ".concat(e)}})},getRecipe:async e=>{let t=await o();return i("/recipes/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})},getAllSuggestions:async()=>{let e=await o();return i("/recipes",{headers:{Authorization:"Bearer ".concat(e)}})}},l={async getProfile(){let e=await o();return i("/profile",{headers:{Authorization:"Bearer ".concat(e)}})},async updateProfile(e){let t=await o();return i("/profile",{method:"PATCH",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(e)})},async createProfile(){let e=await o();return i("/profile",{method:"POST",headers:{Authorization:"Bearer ".concat(e)}})}}},2870:(e,t,a)=>{"use strict";a.d(t,{A:()=>i,c:()=>n});var r=a(2115);let n=(0,r.createContext)(void 0);function i(){let e=(0,r.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},1712:(e,t,a)=>{"use strict";a.d(t,{N:()=>r});let r=(0,a(5974).UU)("https://sbsieimlilcoejrqhlna.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNic2llaW1saWxjb2VqcnFobG5hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzM0NjE5NjYsImV4cCI6MjA0OTAzNzk2Nn0.GT2msD-xjfOX6mhNPek7TiDCjIao8ZVvLnJtXoSrdO4",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"},db:{schema:"public"}})},347:()=>{},9574:e=>{e.exports={style:{fontFamily:"'geistMono', 'geistMono Fallback'"},className:"__className_c3aa02",variable:"__variable_c3aa02"}},2807:e=>{e.exports={style:{fontFamily:"'geistSans', 'geistSans Fallback'"},className:"__className_1e4310",variable:"__variable_1e4310"}}},e=>{var t=t=>e(e.s=t);e.O(0,[659,385,441,517,358],()=>t(5741)),_N_E=e.O()}]);