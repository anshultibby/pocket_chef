(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{5741:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,347,23)),Promise.resolve().then(a.t.bind(a,2807,23)),Promise.resolve().then(a.t.bind(a,9574,23)),Promise.resolve().then(a.bind(a,7454)),Promise.resolve().then(a.bind(a,4158))},7454:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>l});var r=a(5155),n=a(2115),o=a(1712),i=a(2870),s=a(6046),c=a(7078);function l(e){let{children:t}=e,[a,l]=(0,n.useState)(null),[u,d]=(0,n.useState)(null),[h,p]=(0,n.useState)(!0),[w,f]=(0,n.useState)(null),y=(0,s.useRouter)();(0,n.useEffect)(()=>{(async()=>{try{var e;let{data:{session:t},error:a}=await o.N.auth.getSession();if(a)throw a;d(t),l(null!==(e=null==t?void 0:t.user)&&void 0!==e?e:null);let{data:{subscription:r}}=o.N.auth.onAuthStateChange(async(e,t)=>{var a;d(t),l(null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null),y.refresh()});return()=>r.unsubscribe()}catch(e){console.error("Auth initialization error:",e),f(e instanceof Error?e:Error("Auth initialization failed"))}finally{p(!1)}})()},[y]);let g=(0,n.useMemo)(()=>({user:a,session:u,loading:h,error:w,signIn:async(e,t)=>{let{error:a}=await o.N.auth.signInWithPassword({email:e,password:t});if(a)throw a},signUp:async(e,t,a)=>{let{data:r,error:n}=await o.N.auth.signUp({email:e,password:t,options:{data:{name:a}}});if(n)throw n;if(r.session){d(r.session),l(r.session.user);try{return await c.gu.createProfile(),y.push("/onboarding"),{session:r.session,isNewUser:!0}}catch(e){console.error("Error creating profile:",e)}}return{session:r.session,isNewUser:!0}},signOut:async()=>{let{error:e}=await o.N.auth.signOut();if(e)throw e;y.push("/login")},deleteAccount:async()=>{try{await c.i$.deleteAccount(),await o.N.auth.signOut(),y.push("/login?message=account-deleted")}catch(e){throw console.error("Error deleting account:",e),e}}}),[a,u,h,w,y]);return(0,r.jsx)(i.c.Provider,{value:g,children:t})}},4158:(e,t,a)=>{"use strict";a.d(t,{AnalyticsProvider:()=>d});var r=a(5155),n=a(2115),o=()=>{window.va||(window.va=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];(window.vaq=window.vaq||[]).push(t)})};function i(){return"undefined"!=typeof window}function s(){return"production"}function c(){return"development"===((i()?window.vam:s())||"production")}function l(e){return(0,n.useEffect)(()=>{var t;e.beforeSend&&(null==(t=window.va)||t.call(window,"beforeSend",e.beforeSend))},[e.beforeSend]),(0,n.useEffect)(()=>{!function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{debug:!0};if(!i())return;(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto";if("auto"===e){window.vam=s();return}window.vam=e})(t.mode),o(),t.beforeSend&&(null==(e=window.va)||e.call(window,"beforeSend",t.beforeSend));let a=t.scriptSrc||(c()?"https://va.vercel-scripts.com/v1/script.debug.js":"/_vercel/insights/script.js");if(document.head.querySelector('script[src*="'.concat(a,'"]')))return;let r=document.createElement("script");r.src=a,r.defer=!0,r.dataset.sdkn="@vercel/analytics"+(t.framework?"/".concat(t.framework):""),r.dataset.sdkv="1.4.1",t.disableAutoTrack&&(r.dataset.disableAutoTrack="1"),t.endpoint&&(r.dataset.endpoint=t.endpoint),t.dsn&&(r.dataset.dsn=t.dsn),r.onerror=()=>{let e=c()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log("[Vercel Web Analytics] Failed to load script from ".concat(a,". ").concat(e))},c()&&!1===t.debug&&(r.dataset.debug="false"),document.head.appendChild(r)}({framework:e.framework||"react",...void 0!==e.route&&{disableAutoTrack:!0},...e})},[]),(0,n.useEffect)(()=>{e.route&&e.path&&function(e){var t;let{route:a,path:r}=e;null==(t=window.va)||t.call(window,"pageview",{route:a,path:r})}({route:e.route,path:e.path})},[e.route,e.path]),null}async function u(){var e,t,a;let r=null===(a=window)||void 0===a?void 0:null===(t=a.webkit)||void 0===t?void 0:null===(e=t.messageHandlers)||void 0===e?void 0:e.tracking;return(null==r?void 0:r.postMessage)?new Promise(e=>{let t="handleTrackingResponse_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));window[t]=a=>{console.log("Tracking permission response:",a),e(a),delete window[t]},r.postMessage(JSON.stringify({action:"requestPermission",callback:t}))}):(console.log("No tracking bridge, defaulting to true"),!0)}function d(){let[e,t]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{(async()=>{t(await u())})()},[]),e)?(0,r.jsx)(l,{}):null}},7078:(e,t,a)=>{"use strict";a.d(t,{cq:()=>w,dt:()=>d,gu:()=>p,Hv:()=>h,i$:()=>f});var r=a(1712),n=a(6092),o=a(9250);let i="https://pocketchef-production.up.railway.app",s=e=>e.includes("127.0.0.1")||e.includes("localhost")?e:e.replace("http://","https://"),c=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let{data:{session:a}}=await r.N.auth.getSession();if(console.log("Request URL:",e),console.log("Full URL:","".concat(i).concat(e)),console.log("Environment:","production"),!(null==a?void 0:a.access_token))throw console.error("No active session"),new n.U({status:401,message:"No active session"});let c=new Headers({Authorization:"Bearer ".concat(a.access_token),"Content-Type":"application/json"});if(t.headers&&Object.entries(t.headers).forEach(e=>{let[t,a]=e;c.set(t,a)}),o.Ii.isNativePlatform()){console.log("Mobile detected, using Railway"),console.log("Request headers:",Object.fromEntries(c.entries()));let a=await fetch("".concat(i).concat(e),{...t,headers:c});if(console.log("Railway response status:",a.status),!a.ok){let e=await a.text();throw console.error("Railway API Error:",a.status,e),new n.U({status:a.status,message:e||"Request failed"})}return a.json()}let l=await fetch(s("".concat(i).concat(e)),{...t,headers:c,credentials:"include"});if(!l.ok){let e=await l.text();throw console.error("API Error:",l.status,e),new n.U({status:l.status,message:e||"Request failed"})}return l.json()}catch(e){if(console.error("Fetch error:",e),e instanceof n.U)throw e;throw new n.U({status:500,message:"Network error",details:e})}},l=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;try{return await c(e,t)}catch(r){if(a>0&&r instanceof ApiException&&r.error.status>=500)return await new Promise(e=>setTimeout(e,1e3)),l(e,t,a-1);throw r}},u=async()=>{let{data:{session:e}}=await r.N.auth.getSession();if(!e)throw Error("Not authenticated");return e.access_token},d={async getItems(){let e=await u();return c("/pantry/items",{headers:{Authorization:"Bearer ".concat(e)}})},async addItems(e){let t=await u();return c("/pantry/items",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(e)})},async updateItem(e,t){let a=await u();return c("/pantry/items/".concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(t)})},async deleteItem(e){let t=await u();return c("/pantry/items/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})},async clearPantry(){let e=await u();return c("/pantry/clear",{method:"POST",headers:{Authorization:"Bearer ".concat(e)}})},processReceipt:async e=>{let t=await u();return c("/pantry/receipt/process",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:e})},receipt:{process:async e=>{let t=await u();return c("/pantry/receipt/process",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:e})}}},h={generate:async e=>{let t=await u();return c("/recipes/generate",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(e)})},linkIngredients:async e=>{let t=await u();return c("/recipes/".concat(e,"/link-ingredients"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)}})},getRecipeDetails:async e=>{let t=await u();return c("/recipes/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})},delete:async e=>{let t=await u();return c("/recipes/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})},interact:async(e,t)=>{let a=await u();return c("/recipes/".concat(e,"/interact"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(t)})},getInteractions:async(e,t)=>{let a=await u();return c("".concat(e?"/recipes/".concat(e,"/interactions"):"/recipes/interactions").concat(t?"?interaction_type=".concat(t):""),{headers:{Authorization:"Bearer ".concat(a)}})},isSaveData:e=>"folder"in e||"notes"in e,saveRecipe:async(e,t)=>{try{return await h.interact(e,{type:"save",data:{folder:t}})}catch(t){if(t instanceof Error&&t.message.includes("duplicate key value")){let t=await h.getInteractions(e,"save");if(t.length>0)return t[0]}throw t}},rateRecipe:async(e,t,a)=>{let r=(await h.getInteractions(e)).find(e=>"rate"===e.type);return r?c("/recipes/".concat(e,"/interactions/").concat(r.id),{method:"PATCH",headers:{Authorization:"Bearer ".concat(await u()),"Content-Type":"application/json"},body:JSON.stringify({type:"rate",data:{rating:t,review:a}})}):h.interact(e,{type:"rate",data:{rating:t,review:a}})},use:async(e,t)=>h.interact(e,{type:"cook",data:t}),getAll:async()=>{let e=await u();return c("/recipes",{headers:{Authorization:"Bearer ".concat(e)}})},getRecipe:async e=>{let t=await u();return c("/recipes/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})},getAllSuggestions:async()=>{let e=await u();return c("/recipes",{headers:{Authorization:"Bearer ".concat(e)}})}},p={async getProfile(){let e=await u();return c("/profile",{headers:{Authorization:"Bearer ".concat(e)}})},async updateProfile(e){let t=await u();return c("/profile",{method:"PATCH",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(e)})},async createProfile(){let e=await u();return c("/profile",{method:"POST",headers:{Authorization:"Bearer ".concat(e)}})}},w={submit:async e=>{let t=await u();return c("/feedback",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({content:e})})}},f={deleteAccount:async()=>{let e=await u();return c("/users/me",{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})}}},2870:(e,t,a)=>{"use strict";a.d(t,{A:()=>o,c:()=>n});var r=a(2115);let n=(0,r.createContext)(void 0);function o(){let e=(0,r.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},1712:(e,t,a)=>{"use strict";a.d(t,{N:()=>r});let r=(0,a(5974).UU)("https://sbsieimlilcoejrqhlna.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNic2llaW1saWxjb2VqcnFobG5hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzM0NjE5NjYsImV4cCI6MjA0OTAzNzk2Nn0.GT2msD-xjfOX6mhNPek7TiDCjIao8ZVvLnJtXoSrdO4",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"},db:{schema:"public"}})},6092:(e,t,a)=>{"use strict";a.d(t,{U:()=>r});class r extends Error{constructor(e){super(e.message),this.error=e,this.name="ApiException"}}},347:()=>{},9574:e=>{e.exports={style:{fontFamily:"'geistMono', 'geistMono Fallback'"},className:"__className_c3aa02",variable:"__variable_c3aa02"}},2807:e=>{e.exports={style:{fontFamily:"'geistSans', 'geistSans Fallback'"},className:"__className_1e4310",variable:"__variable_1e4310"}}},e=>{var t=t=>e(e.s=t);e.O(0,[659,466,441,517,358],()=>t(5741)),_N_E=e.O()}]);