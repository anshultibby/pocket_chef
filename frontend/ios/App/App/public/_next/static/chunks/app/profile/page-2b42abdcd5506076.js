(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{10:(e,t,a)=>{Promise.resolve().then(a.bind(a,8891))},8891:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var r=a(5155),s=a(2115),n=a(9606),i=a(7916),o=a(9827),l=a(7078);let c=(0,o.v)(e=>({profile:null,isLoading:!1,error:null,setProfile:t=>e({profile:t}),setError:t=>e({error:t}),fetchProfile:async()=>{try{e({isLoading:!0,error:null});let t=await l.gu.getProfile();e({profile:t,isLoading:!1})}catch(t){e({error:t instanceof Error?t.message:"Failed to load profile",isLoading:!1})}},updateProfile:async t=>{try{e({isLoading:!0,error:null});let a=await l.gu.updateProfile(t);e({profile:a,isLoading:!1})}catch(t){throw e({error:t instanceof Error?t.message:"Failed to update profile",isLoading:!1}),t}}}));function d(e){let{label:t,error:a,required:s,children:n,className:i=""}=e,o=t?t.toLowerCase().replace(/\s+/g,"-"):void 0;return(0,r.jsxs)("div",{className:"space-y-1 ".concat(i),children:[t&&(0,r.jsxs)("label",{htmlFor:o,className:"block text-sm font-medium text-gray-300",children:[t,s&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),n,a&&(0,r.jsx)("p",{className:"text-sm text-red-400",role:"alert",children:a})]})}function u(e){let{name:t,control:a,label:s,placeholder:i,required:o,disabled:l,rows:c=4,className:u=""}=e,{field:{value:h,onChange:p},fieldState:{error:m}}=(0,n.as)({name:t,control:a,rules:{required:!!o&&"This field is required"}});return(0,r.jsx)(d,{label:s,error:null==m?void 0:m.message,required:o,children:(0,r.jsx)("textarea",{value:h,onChange:p,placeholder:i,disabled:l,rows:c,className:"w-full bg-gray-800 rounded-lg px-4 py-2 text-white \n                   placeholder:text-gray-500 resize-vertical min-h-[100px]\n                   disabled:opacity-50 disabled:cursor-not-allowed\n                   focus:outline-none focus:ring-2 focus:ring-blue-500\n                   ".concat(m?"ring-1 ring-red-500":"","\n                   ").concat(u)})})}let h=["Vegetarian","Vegan","Pescatarian","Gluten-Free","Dairy-Free","Keto","Paleo","Low-Carb","Low-Fat","Mediterranean","Halal","Kosher"],p=["Save Money","Meal Planning","Track Nutrition","Learn Cooking","Eat Healthier","Reduce Food Waste","Cook More Often","Try New Recipes","Weight Management","Family Meals"],m={BEGINNER:"beginner",INTERMEDIATE:"intermediate",ADVANCED:"advanced"},g={[m.BEGINNER]:"Beginner",[m.INTERMEDIATE]:"Intermediate",[m.ADVANCED]:"Advanced"},x=[1,2,3,4,5,6,8,10,12];var y=a(6046);function f(e){var t;let{name:a,value:s,control:i}=e,{field:o}=(0,n.as)({name:a,control:i,defaultValue:[]}),l=null===(t=o.value)||void 0===t?void 0:t.includes(s);return(0,r.jsx)("button",{type:"button",onClick:()=>{let e=l?o.value.filter(e=>e!==s):[...o.value||[],s];o.onChange(e)},className:"px-4 py-2 rounded-lg text-sm transition-all ".concat(l?"bg-blue-500/20 text-blue-400 ring-1 ring-blue-500/50":"bg-gray-800 text-gray-400 hover:bg-gray-700"),children:s})}function b(e){let{name:t,value:a,control:s}=e,{field:i}=(0,n.as)({name:t,control:s,defaultValue:2}),o=i.value===a;return(0,r.jsx)("button",{type:"button",onClick:()=>i.onChange(a),className:"px-4 py-2 rounded-lg text-sm transition-all ".concat(o?"bg-green-500/20 text-green-400 ring-1 ring-green-500/50":"bg-gray-800 text-gray-400 hover:bg-gray-700"),children:a})}function w(e){let{name:t,value:a,label:s,control:i}=e,{field:o}=(0,n.as)({name:t,control:i,defaultValue:"beginner"}),l=o.value===a;return(0,r.jsx)("button",{type:"button",onClick:()=>o.onChange(a),className:"px-4 py-2 rounded-lg text-sm transition-all ".concat(l?"bg-purple-500/20 text-purple-400 ring-1 ring-purple-500/50":"bg-gray-800 text-gray-400 hover:bg-gray-700"),children:s})}var v=a(4317),N=a(2870),j=a(5037);function E(e){let{onClose:t}=e,[a,n]=(0,s.useState)(""),[i,o]=(0,s.useState)(!1),{deleteAccount:l}=(0,N.A)(),c=async e=>{if(e.preventDefault(),e.stopPropagation(),"DELETE"===a)try{o(!0),await l()}catch(e){console.error("Error deleting account:",e),j.oR.error("Failed to delete account"),o(!1)}};return(0,r.jsxs)(v.lG,{open:!0,onClose:()=>{},className:"relative z-50",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/70","aria-hidden":"true"}),(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,r.jsxs)(v.lG.Panel,{className:"w-full max-w-md rounded-lg bg-gray-900 p-6",children:[(0,r.jsx)(v.lG.Title,{className:"text-xl font-bold text-white mb-4",children:"Delete Account"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"bg-red-900/30 border border-red-500/50 rounded-lg p-4",children:(0,r.jsx)("p",{className:"text-red-200 text-sm",children:"Warning: This action is permanent and cannot be undone. All your data, including recipes, pantry items, and preferences will be permanently deleted."})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm text-gray-400",children:"Type DELETE to confirm"}),(0,r.jsx)("input",{type:"text",value:a,onChange:e=>n(e.target.value),className:"w-full bg-gray-800 rounded-lg px-3 py-2 text-white border border-gray-700",placeholder:"Type DELETE"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,r.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),t()},className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),(0,r.jsx)("button",{type:"button",onClick:c,disabled:"DELETE"!==a||i,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Deleting...":"Delete Account"})]})]})})]})}let A={dietary_preferences:[],goals:[],cooking_experience:"beginner",default_servings:2,notes:""};function C(){let e=(0,y.useRouter)(),{profile:t,updateProfile:a}=c(),{register:o,control:l,reset:d,handleSubmit:m,formState:{isSubmitting:v}}=(0,n.mN)({defaultValues:async()=>{let{profile:e}=c.getState();return await c.getState().fetchProfile(),e||A}});(0,s.useEffect)(()=>{if(t){var e;d({dietary_preferences:t.dietary_preferences,goals:t.goals,cooking_experience:t.cooking_experience,default_servings:t.default_servings,notes:null!==(e=t.notes)&&void 0!==e?e:""})}},[t,d]);let N=async t=>{try{await a(t),e.push("/home")}catch(e){console.error("Error updating profile:",e)}},[j,C]=(0,s.useState)(!1);return(0,r.jsx)(i.q,{children:(0,r.jsx)("div",{className:"min-h-screen bg-gray-950 text-white",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-12",children:[(0,r.jsxs)("form",{onSubmit:m(N),className:"bg-gray-900 rounded-lg mb-8",children:[(0,r.jsx)("div",{className:"sticky top-0 z-10 bg-gray-900 p-8 border-b border-gray-800 rounded-t-lg",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:"Profile Settings"}),(0,r.jsxs)("div",{className:"flex gap-3 w-full sm:w-auto",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{e.push("/home")},className:"w-full sm:w-auto px-6 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600  disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:v,className:"w-full sm:w-auto px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700  disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",children:v?"Saving...":"Save Changes"})]})]})}),(0,r.jsx)("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:(0,r.jsxs)("div",{className:"space-y-6 bg-gray-800/50 rounded-xl p-4 sm:p-6 backdrop-blur-sm",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Basic Information"}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"Display Name"}),(0,r.jsx)("input",{type:"text",className:"w-full bg-gray-700/50 rounded-lg px-3 py-2 text-white"})]})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Preferences"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"Your Goals"}),(0,r.jsx)("div",{className:"overflow-x-auto pb-2",children:(0,r.jsx)("div",{className:"flex flex-nowrap gap-2",children:p.map(e=>(0,r.jsx)(f,{name:"goals",value:e,control:l},e))})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"Dietary Preferences"}),(0,r.jsx)("div",{className:"overflow-x-auto pb-2",children:(0,r.jsx)("div",{className:"flex flex-nowrap gap-2",children:h.map(e=>(0,r.jsx)(f,{name:"dietary_preferences",value:e,control:l},e))})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"Cooking Experience"}),(0,r.jsx)("div",{className:"overflow-x-auto pb-2",children:(0,r.jsx)("div",{className:"flex flex-nowrap gap-2",children:Object.entries(g).map(e=>{let[t,a]=e;return(0,r.jsx)(w,{name:"cooking_experience",value:t,label:a,control:l},t)})})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"Default Servings"}),(0,r.jsx)("div",{className:"overflow-x-auto pb-2",children:(0,r.jsx)("div",{className:"flex flex-nowrap gap-2",children:x.map(e=>(0,r.jsx)(b,{name:"default_servings",value:e,control:l},e))})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"Notes"}),(0,r.jsx)(u,{name:"notes",control:l,placeholder:"Any additional notes about your preferences...",className:"bg-gray-700/50"})]})]})]})})]}),(0,r.jsx)("div",{className:"mt-8 space-y-6 bg-gray-900 rounded-lg p-6",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-red-400",children:"Danger Zone"}),(0,r.jsx)("div",{className:"border border-red-500/20 rounded-lg p-4 bg-red-950/20",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-red-200",children:"Delete Account"}),(0,r.jsx)("p",{className:"text-sm text-red-200/70",children:"Permanently delete your account and all associated data"})]}),(0,r.jsx)("button",{type:"button",onClick:()=>C(!0),className:"px-4 py-2 bg-red-600/20 text-red-400 rounded-lg hover:bg-red-600/30 transition-colors",children:"Delete Account"})]})})]})}),j&&(0,r.jsx)(E,{onClose:()=>C(!1)})]})})})}},7916:(e,t,a)=>{"use strict";a.d(t,{q:()=>o});var r=a(5155),s=a(2870),n=a(6046),i=a(2115);function o(e){let{children:t}=e,{user:a,loading:o}=(0,s.A)(),l=(0,n.useRouter)(),c=(0,n.usePathname)();return((0,i.useEffect)(()=>{!o&&(a?["/login","/signup"].includes(c)&&l.push("/home"):["/home","/profile","/settings"].includes(c)&&l.push("/login"))},[a,o,l,c]),o)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):(0,r.jsx)(r.Fragment,{children:t})}},7078:(e,t,a)=>{"use strict";a.d(t,{cq:()=>m,dt:()=>u,gu:()=>p,Hv:()=>h,i$:()=>g});var r=a(1712),s=a(6092),n=a(9250);let i="https://pocketchef-production.up.railway.app",o=e=>e.includes("127.0.0.1")||e.includes("localhost")?e:e.replace("http://","https://"),l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let{data:{session:a}}=await r.N.auth.getSession();if(console.log("Request URL:",e),console.log("Full URL:","".concat(i).concat(e)),console.log("Environment:","production"),!(null==a?void 0:a.access_token))throw console.error("No active session"),new s.U({status:401,message:"No active session"});let l=new Headers({Authorization:"Bearer ".concat(a.access_token),"Content-Type":"application/json"});if(t.headers&&Object.entries(t.headers).forEach(e=>{let[t,a]=e;l.set(t,a)}),n.Ii.isNativePlatform()){console.log("Mobile detected, using Railway"),console.log("Request headers:",Object.fromEntries(l.entries()));let a=await fetch("".concat(i).concat(e),{...t,headers:l});if(console.log("Railway response status:",a.status),!a.ok){let e=await a.text();throw console.error("Railway API Error:",a.status,e),new s.U({status:a.status,message:e||"Request failed"})}return a.json()}let c=await fetch(o("".concat(i).concat(e)),{...t,headers:l,credentials:"include"});if(!c.ok){let e=await c.text();throw console.error("API Error:",c.status,e),new s.U({status:c.status,message:e||"Request failed"})}return c.json()}catch(e){if(console.error("Fetch error:",e),e instanceof s.U)throw e;throw new s.U({status:500,message:"Network error",details:e})}},c=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;try{return await l(e,t)}catch(r){if(a>0&&r instanceof ApiException&&r.error.status>=500)return await new Promise(e=>setTimeout(e,1e3)),c(e,t,a-1);throw r}},d=async()=>{let{data:{session:e}}=await r.N.auth.getSession();if(!e)throw Error("Not authenticated");return e.access_token},u={async getItems(){let e=await d();return l("/pantry/items",{headers:{Authorization:"Bearer ".concat(e)}})},async addItems(e){let t=await d();return l("/pantry/items",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(e)})},async updateItem(e,t){let a=await d();return l("/pantry/items/".concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(t)})},async deleteItem(e){let t=await d();return l("/pantry/items/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})},async clearPantry(){let e=await d();return l("/pantry/clear",{method:"POST",headers:{Authorization:"Bearer ".concat(e)}})},processReceipt:async e=>{let t=await d();return l("/pantry/receipt/process",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:e})},receipt:{process:async e=>{let t=await d();return l("/pantry/receipt/process",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:e})}}},h={generate:async e=>{let t=await d();return l("/recipes/generate",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(e)})},linkIngredients:async e=>{let t=await d();return l("/recipes/".concat(e,"/link-ingredients"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)}})},getRecipeDetails:async e=>{let t=await d();return l("/recipes/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})},delete:async e=>{let t=await d();return l("/recipes/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})},interact:async(e,t)=>{let a=await d();return l("/recipes/".concat(e,"/interact"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(t)})},getInteractions:async(e,t)=>{let a=await d();return l("".concat(e?"/recipes/".concat(e,"/interactions"):"/recipes/interactions").concat(t?"?interaction_type=".concat(t):""),{headers:{Authorization:"Bearer ".concat(a)}})},isSaveData:e=>"folder"in e||"notes"in e,saveRecipe:async(e,t)=>{try{return await h.interact(e,{type:"save",data:{folder:t}})}catch(t){if(t instanceof Error&&t.message.includes("duplicate key value")){let t=await h.getInteractions(e,"save");if(t.length>0)return t[0]}throw t}},rateRecipe:async(e,t,a)=>{let r=(await h.getInteractions(e)).find(e=>"rate"===e.type);return r?l("/recipes/".concat(e,"/interactions/").concat(r.id),{method:"PATCH",headers:{Authorization:"Bearer ".concat(await d()),"Content-Type":"application/json"},body:JSON.stringify({type:"rate",data:{rating:t,review:a}})}):h.interact(e,{type:"rate",data:{rating:t,review:a}})},use:async(e,t)=>h.interact(e,{type:"cook",data:t}),getAll:async()=>{let e=await d();return l("/recipes",{headers:{Authorization:"Bearer ".concat(e)}})},getRecipe:async e=>{let t=await d();return l("/recipes/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})},getAllSuggestions:async()=>{let e=await d();return l("/recipes",{headers:{Authorization:"Bearer ".concat(e)}})}},p={async getProfile(){let e=await d();return l("/profile",{headers:{Authorization:"Bearer ".concat(e)}})},async updateProfile(e){let t=await d();return l("/profile",{method:"PATCH",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(e)})},async createProfile(){let e=await d();return l("/profile",{method:"POST",headers:{Authorization:"Bearer ".concat(e)}})}},m={submit:async e=>{let t=await d();return l("/feedback",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({content:e})})}},g={deleteAccount:async()=>{let e=await d();return l("/users/me",{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})}}},2870:(e,t,a)=>{"use strict";a.d(t,{A:()=>n,c:()=>s});var r=a(2115);let s=(0,r.createContext)(void 0);function n(){let e=(0,r.useContext)(s);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},1712:(e,t,a)=>{"use strict";a.d(t,{N:()=>r});let r=(0,a(5974).UU)("https://sbsieimlilcoejrqhlna.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNic2llaW1saWxjb2VqcnFobG5hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzM0NjE5NjYsImV4cCI6MjA0OTAzNzk2Nn0.GT2msD-xjfOX6mhNPek7TiDCjIao8ZVvLnJtXoSrdO4",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"},db:{schema:"public"}})},6092:(e,t,a)=>{"use strict";a.d(t,{U:()=>r});class r extends Error{constructor(e){super(e.message),this.error=e,this.name="ApiException"}}}},e=>{var t=t=>e(e.s=t);e.O(0,[466,491,606,441,517,358],()=>t(10)),_N_E=e.O()}]);